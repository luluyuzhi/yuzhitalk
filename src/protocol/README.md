想把这个 statemachine 改成状态模式。

1. 但是真的是没时间了。
2. 真的没时间了。
3. 没时间了。
4. 没时间了。
5. 没时间了。
6. 没时间了。

我希望状态与消息绑定，而不是状态与状态之间的绑定。

我还希望在每个状态处理中都能以发布订阅的方式来处理消息状态变化引起的事件。
例如在消息第一次推送的时候，我们将消息可能会做一些检测，比如文本内容是否合法，图像是否合法，音频是否合法，等等。
一种是链式的，比如检测文本内容是否合法，如果合法，就把文本内容推送给消息处理程序，如果不合法，就把消息推送给消息处理程序。
一种是发布订阅，但是发布订阅这种并不会把错误消息推送给消息处理程序，而是把错误消息推送给错误处理程序。
